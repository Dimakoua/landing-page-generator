const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Accordion.stories-BAE4Tx7b.js","./Accordion-EAN67bPc.js","./jsx-runtime-u17CrQMm.js","./index-Bi6L2ga8.js","./useActionDispatch-DI3rZtA0.js","./Cart-DWZ99Yi5.js","./CheckoutForm.stories-CAAQUis2.js","./CheckoutForm-DZjKHgqt.js","./Confirmation.stories-DlweZNyw.js","./Confirmation-B-NA24tR.js","./Footer.stories-CxM0w70V.js","./Footer-C4Wp3vLk.js","./HeatmapRecorder.stories-BsHXvx91.js","./HeatmapRecorder-DdyNRJ6r.js","./Hero.stories-mFNVXdR3.js","./Hero-CqdJFctz.js","./Navigation.stories-CdRjwGSO.js","./Navigation-DAMEDo2v.js","./RecommendedProducts.stories-B-phbCRc.js","./RecommendedProducts-DLR9R8LU.js","./Testimonials.stories-7OD58iNT.js","./Testimonials-BSY5Ufzx.js"])))=>i.map(i=>d[i]);
import{j as h}from"./jsx-runtime-u17CrQMm.js";import{r as d}from"./index-Bi6L2ga8.js";import{_ as r}from"./iframe-BNZ--PW5.js";function V(){const e=d.useCallback((n,i)=>{let p=i;return i.startsWith("state.")&&(p=i.slice(6)),p.split(".").reduce((t,s)=>{if(t!=null)return t[s]},n)},[]),o=d.useCallback((n,i)=>{if(typeof n!="string")return n;const p=/\{\{(.+?)\}\}/g;if(!p.test(n))return n;const m=n.match(/^\{\{(.+?)\}\}$/);if(m){const t=m[1].trim();return e(i,t)}return n.replace(p,(t,s)=>{const u=e(i,s.trim());return String(u??"")})},[e]),c=d.useCallback((n,i)=>{const p={};for(const[m,t]of Object.entries(n))typeof t=="string"?p[m]=o(t,i):Array.isArray(t)?p[m]=t.map(s=>typeof s=="object"&&s!==null?c(s,i):o(s,i)):typeof t=="object"&&t!==null?p[m]=c(t,i):p[m]=t;return p},[o]);return{getNestedValue:e,interpolateValue:o,interpolateObject:c}}function k(e){const o=e.split("/"),c=o[o.length-1];if(/^index\./i.test(c))return o[o.length-2].replace(/[-_](.)/g,(s,u)=>u.toUpperCase()).replace(/^(.)/,s=>s.toUpperCase());const n=c.replace(/\.[^.]+$/,""),i=n.replace(/[-_](.)/g,(t,s)=>s.toUpperCase()),p=/[-_]/.test(n);return c.includes(".")||p?i.replace(/^(.)/,t=>t.toUpperCase()):i}const L={},x=Object.assign({"../components/accordion/Accordion.stories.tsx":()=>r(()=>import("./Accordion.stories-BAE4Tx7b.js"),__vite__mapDeps([0,1,2,3,4]),import.meta.url),"../components/accordion/Accordion.tsx":()=>r(()=>import("./Accordion-EAN67bPc.js"),__vite__mapDeps([1,2,3,4]),import.meta.url),"../components/accordion/Cart.tsx":()=>r(()=>import("./Cart-DWZ99Yi5.js"),__vite__mapDeps([5,2,3,4]),import.meta.url),"../components/checkout/CheckoutForm.stories.tsx":()=>r(()=>import("./CheckoutForm.stories-CAAQUis2.js"),__vite__mapDeps([6,7,2,3,4]),import.meta.url),"../components/checkout/CheckoutForm.tsx":()=>r(()=>import("./CheckoutForm-DZjKHgqt.js"),__vite__mapDeps([7,2,3,4]),import.meta.url),"../components/confirmation/Confirmation.stories.tsx":()=>r(()=>import("./Confirmation.stories-DlweZNyw.js"),__vite__mapDeps([8,9,2,3,4]),import.meta.url),"../components/confirmation/Confirmation.tsx":()=>r(()=>import("./Confirmation-B-NA24tR.js"),__vite__mapDeps([9,2,3,4]),import.meta.url),"../components/fetchfromapi/LoadFromApi.stories.tsx":()=>r(()=>Promise.resolve().then(()=>G),void 0,import.meta.url),"../components/fetchfromapi/LoadFromApi.tsx":()=>r(()=>Promise.resolve().then(()=>q),void 0,import.meta.url),"../components/footer/Footer.stories.tsx":()=>r(()=>import("./Footer.stories-CxM0w70V.js"),__vite__mapDeps([10,11,2,3,4]),import.meta.url),"../components/footer/Footer.tsx":()=>r(()=>import("./Footer-C4Wp3vLk.js"),__vite__mapDeps([11,2,3,4]),import.meta.url),"../components/heatmaprecorder/HeatmapRecorder.stories.tsx":()=>r(()=>import("./HeatmapRecorder.stories-BsHXvx91.js"),__vite__mapDeps([12,13,3]),import.meta.url),"../components/heatmaprecorder/HeatmapRecorder.tsx":()=>r(()=>import("./HeatmapRecorder-DdyNRJ6r.js"),__vite__mapDeps([13,3]),import.meta.url),"../components/hero/Hero.stories.tsx":()=>r(()=>import("./Hero.stories-mFNVXdR3.js"),__vite__mapDeps([14,15,2,3,4]),import.meta.url),"../components/hero/Hero.tsx":()=>r(()=>import("./Hero-CqdJFctz.js"),__vite__mapDeps([15,2,3,4]),import.meta.url),"../components/navigation/Navigation.stories.tsx":()=>r(()=>import("./Navigation.stories-CdRjwGSO.js"),__vite__mapDeps([16,17,2,3,4]),import.meta.url),"../components/navigation/Navigation.tsx":()=>r(()=>import("./Navigation-DAMEDo2v.js"),__vite__mapDeps([17,2,3,4]),import.meta.url),"../components/products/RecommendedProducts.stories.tsx":()=>r(()=>import("./RecommendedProducts.stories-B-phbCRc.js"),__vite__mapDeps([18,19,2,3,4]),import.meta.url),"../components/products/RecommendedProducts.tsx":()=>r(()=>import("./RecommendedProducts-DLR9R8LU.js"),__vite__mapDeps([19,2,3,4]),import.meta.url),"../components/testimonials/Testimonials.stories.tsx":()=>r(()=>import("./Testimonials.stories-7OD58iNT.js"),__vite__mapDeps([20,21,2,3]),import.meta.url),"../components/testimonials/Testimonials.tsx":()=>r(()=>import("./Testimonials-BSY5Ufzx.js"),__vite__mapDeps([21,2,3]),import.meta.url)});for(const e in x)try{const o=k(e);L[o]=d.lazy(async()=>{const c=await x[e]();return{default:c.default||c[o]||Object.values(c)[0]}})}catch(o){console.warn("[ComponentMap] failed to register",e,o)}function b({section:e,index:o,interpolateObject:c,engineState:n,dispatcher:i,slug:p,stepId:m,variant:t}){const s=L[e.component];if(!s)return h.jsxs("div",{className:"fallback p-4 border-2 border-red-300 bg-red-50 text-red-700 rounded",children:["Unknown component: ",e.component]},o);const u={...e.props?c(e.props,n):{},dispatcher:i,actions:e.actions,state:n,slug:p,stepId:m,variant:t},f=h.jsx(s,{...u},o);return e.id?h.jsx("div",{id:e.id,children:f},o):f}b.__docgenInfo={description:"Renders a single section with proper error handling and ID wrapping",methods:[],displayName:"renderSection",props:{section:{required:!0,tsType:{name:"Layout['sections'][number]",raw:"Layout['sections'][number]"},description:""},index:{required:!0,tsType:{name:"number"},description:""},interpolateObject:{required:!0,tsType:{name:"signature",type:"function",raw:"(obj: Record<string, unknown>, state: Record<string, unknown>) => Record<string, unknown>",signature:{arguments:[{type:{name:"Record",elements:[{name:"string"},{name:"unknown"}],raw:"Record<string, unknown>"},name:"obj"},{type:{name:"Record",elements:[{name:"string"},{name:"unknown"}],raw:"Record<string, unknown>"},name:"state"}],return:{name:"Record",elements:[{name:"string"},{name:"unknown"}],raw:"Record<string, unknown>"}}},description:""},engineState:{required:!0,tsType:{name:"Record",elements:[{name:"string"},{name:"unknown"}],raw:"Record<string, unknown>"},description:""},dispatcher:{required:!0,tsType:{name:"ActionDispatcher"},description:""},slug:{required:!0,tsType:{name:"string"},description:""},stepId:{required:!1,tsType:{name:"string"},description:""},variant:{required:!1,tsType:{name:"string"},description:""}}};const v=({endpoint:e,method:o="GET",onError:c,dispatcher:n,state:i={},slug:p,stepId:m,variant:t,cacheEnabled:s=!1,cacheKey:u,ttl:f=300*1e3})=>{const[w,R]=d.useState([]),[O,T]=d.useState(!0),[I,C]=d.useState(null),{interpolateObject:D}=V(),P=u||`lp_factory_api_${btoa(e)}_${o}`,j=_=>{try{const a=localStorage.getItem(_);if(!a)return null;const l=JSON.parse(a);return Date.now()-l.timestamp>l.ttl?(localStorage.removeItem(_),null):l}catch(a){return console.warn("LoadFromApi: Failed to read from cache:",a),null}},S=(_,a,l)=>{try{const E={data:a,timestamp:Date.now(),ttl:l};localStorage.setItem(_,JSON.stringify(E))}catch(E){console.warn("LoadFromApi: Failed to write to cache:",E)}};return d.useEffect(()=>{(async()=>{if(s){const a=j(P);if(a&&(console.log("LoadFromApi: Using cached data for",e),a.data.sections&&Array.isArray(a.data.sections))){R(a.data.sections),T(!1);return}}try{const a=await fetch(e,{method:o});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const l=await a.json();if(l.sections&&Array.isArray(l.sections))R(l.sections),s&&(S(P,l,f),console.log("LoadFromApi: Cached response for",e,"TTL:",f,"ms"));else throw new Error("Invalid response format: missing sections array");T(!1)}catch(a){console.error("LoadFromApi fetch error:",a),C(a.message),T(!1),c&&n&&n.dispatch(c).catch(l=>{console.error("Error dispatching onError action:",l)})}})()},[e,o,c,n,s,P,f]),O?h.jsx("div",{className:"text-center p-4",children:"Loading components..."}):I?null:h.jsx(d.Suspense,{fallback:h.jsx("div",{className:"text-center p-4",children:"Loading components..."}),children:w.map((_,a)=>b({section:_,index:a,interpolateObject:D,engineState:i,dispatcher:n,slug:p,stepId:m,variant:t}))})};v.__docgenInfo={description:"",methods:[],displayName:"LoadFromApi",props:{endpoint:{required:!0,tsType:{name:"string"},description:""},method:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"'GET'",computed:!1}},onError:{required:!1,tsType:{name:"union",raw:`| NavigateAction
| ClosePopupAction
| RedirectAction
| ApiAction
| AnalyticsAction
| PixelAction
| IframeAction
| CustomHtmlAction
| SetStateAction
| ChainAction
| ParallelAction
| ConditionalAction
| DelayAction
| LogAction
| CartAction
| PluginAction`,elements:[{name:"NavigateAction"},{name:"ClosePopupAction"},{name:"RedirectAction"},{name:"ApiAction"},{name:"AnalyticsAction"},{name:"PixelAction"},{name:"IframeAction"},{name:"CustomHtmlAction"},{name:"SetStateAction"},{name:"ChainAction"},{name:"ParallelAction"},{name:"ConditionalAction"},{name:"DelayAction"},{name:"LogAction"},{name:"CartAction"},{name:"PluginAction"}]},description:""},dispatcher:{required:!1,tsType:{name:"ActionDispatcher"},description:""},state:{required:!1,tsType:{name:"Record",elements:[{name:"string"},{name:"unknown"}],raw:"Record<string, unknown>"},description:"",defaultValue:{value:"{}",computed:!1}},slug:{required:!1,tsType:{name:"string"},description:""},stepId:{required:!1,tsType:{name:"string"},description:""},variant:{required:!1,tsType:{name:"string"},description:""},cacheEnabled:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},cacheKey:{required:!1,tsType:{name:"string"},description:""},ttl:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"5 * 60 * 1000",computed:!1}}}};const q=Object.freeze(Object.defineProperty({__proto__:null,default:v},Symbol.toStringTag,{value:"Module"})),F={title:"Components/LoadFromApi",component:v,parameters:{layout:"padded",docs:{description:{component:"Component that loads and renders sections from an API endpoint. This story demonstrates the loading behavior."}}},argTypes:{endpoint:{control:"text"},method:{control:"select",options:["GET","POST","PUT","DELETE"]},cacheEnabled:{control:"boolean"},cacheKey:{control:"text"},ttl:{control:"number"}}},g={args:{endpoint:"https://jsonplaceholder.typicode.com/posts/1",method:"GET",cacheEnabled:!1}},A={args:{endpoint:"https://jsonplaceholder.typicode.com/posts/1",method:"GET",cacheEnabled:!0,cacheKey:"sample_post",ttl:3e5}},y={args:{endpoint:"https://jsonplaceholder.typicode.com/posts",method:"POST",cacheEnabled:!1}};g.parameters={...g.parameters,docs:{...g.parameters?.docs,source:{originalSource:`{
  args: {
    endpoint: 'https://jsonplaceholder.typicode.com/posts/1',
    method: 'GET',
    cacheEnabled: false
  }
}`,...g.parameters?.docs?.source}}};A.parameters={...A.parameters,docs:{...A.parameters?.docs,source:{originalSource:`{
  args: {
    endpoint: 'https://jsonplaceholder.typicode.com/posts/1',
    method: 'GET',
    cacheEnabled: true,
    cacheKey: 'sample_post',
    ttl: 300000 // 5 minutes
  }
}`,...A.parameters?.docs?.source}}};y.parameters={...y.parameters,docs:{...y.parameters?.docs,source:{originalSource:`{
  args: {
    endpoint: 'https://jsonplaceholder.typicode.com/posts',
    method: 'POST',
    cacheEnabled: false
  }
}`,...y.parameters?.docs?.source}}};const N=["Default","WithCaching","PostRequest"],G=Object.freeze(Object.defineProperty({__proto__:null,Default:g,PostRequest:y,WithCaching:A,__namedExportsOrder:N,default:F},Symbol.toStringTag,{value:"Module"}));export{g as Default,y as PostRequest,A as WithCaching,N as __namedExportsOrder,F as default};
